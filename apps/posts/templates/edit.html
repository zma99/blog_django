{% extends 'base.html' %}
{% block content %}
<div class="max-w-2xl mx-auto mt-12 px-4">
  <h2 class="text-2xl font-bold text-gray-800 mb-6">‚úèÔ∏è Editar publicaci√≥n</h2>

    <form method="post" enctype="multipart/form-data">
    {% csrf_token %}
    
    <!-- Campo t√≠tulo -->
    <div class="mb-4">
        {{ form.title.label_tag }}
        {{ form.title }}
        {{ form.title.errors }}
    </div>

    <!-- Campo resumen -->
    <div class="mb-4">
        {{ form.abstract.label_tag }}
        {{ form.abstract }}
        {{ form.abstract.errors }}
    </div>

    <!-- Campo portada -->
    <div class="mb-4">
        <label class="block text-sm font-medium text-gray-700">Imagen de portada actual:</label>
        {% if object.cover %}
        <img src="{{ object.cover.url }}" alt="Portada actual" class="w-64 h-auto my-2 rounded border" />
        {% else %}
        <p class="text-gray-500 italic">Sin imagen de portada.</p>
        {% endif %}

        {{ form.cover.label_tag }}
        {{ form.cover }}
        {{ form.cover.errors }}

        <!-- Ocultar checkbox para eliminar imagen -->
        <style>
        input[type="checkbox"][name$="-clear"] {
            display: none;
        }
        </style>
    </div>

    <!-- Campo cuerpo -->
    <div class="mb-4">
        {{ form.body.label_tag }}
        {{ form.body }}
        {{ form.body.errors }}
    </div>

    <!-- Botones -->
    <div class="mt-6 flex gap-4">
        <button type="submit" class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded font-medium">
        üíæ Guardar cambios
        </button>
        <a href="{% url 'posts:detail' object.pk %}" class="bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded font-medium">
        ‚¨ÖÔ∏è Cancelar
        </a>
    </div>
    </form>

    <script>
  document.addEventListener('DOMContentLoaded', function () {
    const form = document.querySelector('form[enctype="multipart/form-data"]');
    if (!form) return;

    const fileInput = form.querySelector('input[type="file"][name="cover"]');
    if (!fileInput) return;

    form.addEventListener('submit', function (e) {
      if (fileInput.files.length > 0) {
        const respuesta = window.confirm("‚ö†Ô∏è Vas a reemplazar la imagen de portada. ¬øEst√°s seguro?");
        if (!respuesta) {
          e.preventDefault(); // Cancela el env√≠o si no se confirma
        }
      }
    });
  });
</script>
</div>
{% endblock %}
